# CLASS IN C++

面向对象编程(OOP)是一种特殊的、设计程序的概念性方法，C++通过一些特性改进了C语言，是的应用这种方法更容易。下面是最重要的OOP特性：

+ 抽象
+ 封装和数据隐藏
+ 多态
+ 集成
+ 代码的可重用性

C++与其他语言的不同之处在于它不仅仅支持面向对象编程，还支持基于对象、面向过程、泛型编程。

简而言之，类是一种将数据和函数组织在一起的方式。在编程中，我们需要将所有想要的数据一次性包含，最终作为一个类型。由类类型制成的变量叫做对象，新创建对象的过程叫做实例化。

## 过程性编程和面向对象编程

采用过程性编程方法时，首先考虑要遵循的步骤，然后考虑如何表示这些数据。
采用OOP方法时，首先从用户的角度出发考虑对象————描述对象所需的数据以及描述用户于数据交互所需的操作。完成对接口的描述后，需要确定如何实现接口和数据储存。最后，使用新的设计方案创建出程序。

## 抽象和类

首先要确定类型是什么，在指定基本类型是完成了三项工作：

+ 决定数据对象需要的内存数量。
+ 决定如何解释内存中的位(long和float在内存中占用的位数相同，但将它们转换为数值的方法不同)
+ 决定可使用数据对象执行的操作或方法

类是一种将抽象转换为用户定义类型的C++工具，它将数据表示和操纵数据的方法组合成一个整洁的包。
类规范由两个部分组成：

+ 类声明：以数据成员的方式描述数据部分，以成员函数的方式描述公有接口。
+ 类方法定义：描述如何实现类成员函数。

简单的说，类声明提供了类的蓝图，而方法定义则提供了细节。
接口是一个共享框架，供两个系统交互时使用；对于类，我们说公共接口。在这里，公共时使用类的程序，交互系统由类对象组成，而接口由编写类的人提供方法组成。接口让程序员能够编写与类对象交互的代码，从而让程序能够使用类对象。

### 1.访问控制
关键字`private`和`public`也是新的，它们描述了对类成员的访问控制，使用类对象的程序都可以直接访问公有部分，但只能通过公有成员函数(或友元函数)来访问对象的私有成员。因此，公有成员函数是程序和对象的私有成员之间的桥梁，提供了对象和程序之间的接口。防止程序直接访问数据被称为数据隐藏。C++还提供了第三个访问控制关键字`protected`，第13章介绍类继承时将讨论该关键字。
类设计尽可能将公有接口与实现细节分开。公有接口表示设计的抽象组件。将实现细节放在一起并将他们与抽象分开被称为封装。数据隐藏(将数据放在类的私有部分中)是一种封装，将实现的细节隐藏在私有部分。封装的另一个例子是，将类函数定义和类声明放在不同的文件中。
数据隐藏不仅可以防止直接访问数据，还让开发者(类的用户)无需了解数据是如何被表示的。从使用类的角度看，使用哪种方法没有什么区别。所需要的知道的是各种成员函数的功能；也就是说，需要知道成员函数接受什么样的参数以及返回什么类型的值。原则是将实现细节从接口设计中分离开来。如果以后找到了更好的。实现数据表示或成员函数细节的方法，可以对这些细节进行修改，二无需修改程序结构，这使得程序维护起来更容易。
### 2.控制对成员的访问：公有还是私有
无论类成员是数据成员还是成员函数都可以在类的公有部分还是私有部分声明他们，但数据封装是OOP的目标之一，一般将数据成员置于私有部分，将成员函数置于公有部分，但有时也将成员函数置于私有部分，通过公有函数将其定义。
### 3.类和结构的区别
实际上，C++中对结构进行了拓展，使之和类有相同的特性，但是结构中的数据成员和函数都是公有的，无法实现数据封装的作用。
类和结构唯一的区别是，结构的默认访问类型是public，而类是private。C++中常用类来实现描述，而把结构限制为只表示纯粹的数据对象。

## 实现类成员函数
我们在定义类中的数据成员以后，还需要创建类描述的第二部分：为那些由类声明中的原型表示的成员函数提供代码。成员函数定义与常规函数定义非常相似，他们有函数头和函数体，也可以有返回类型和参数。但是它们还有两个特殊的特征：
+ 定义函数成员时，使用作用域解析运算符(::)来指出函数所属的类。如：
   ```c++
   // update()成员函数的函数头定义如下：
   void Stock:: update()
   ```
+ 类方法可以访问类的private组件
  
首先，成员函数的函数头使用作用域运算符解析`::`来指出函数所属的类。例如，`update()`成员函数的函数头如下：
`void Stock::update(double price)`
这种表示方法意味着我们定义的update()函数是Stock类的成员。这不仅将update()标识为成员函数，还意味着我们可以将另一个类的成员函数也命名成update()。例如，Buffoon类的update()函数的函数头如下：
`void Buffoon::update()`
因此，作用域解析运算符确定了方法定义对应的类的身份。我们可以这样认为标识符`update()`具有类作用域(class scope)。Stock类的其他成员函数不必使用作用域解析运算符，就可以使用update()方法，这是因为他们属于用一个类，因此update()是可见的。然而，在类声明和方法定义之外使用update()时，需要采取特殊的措施。
类方法的完成名称中包括类名。我们说，`Stock::update()`是函数的限定名(qualified name);而简单的update()是全名的缩写，他只能在类作用域中使用。
方法的第二个特点是，方法可以访问类的私有成员。
### 内联方法
其定义位于类声明中的函数都将自动成为内联函数，。类声明常将短小的成员函数作为内联函数。如果愿意，也可以在类声明之外定义成员函数，并使其成为内联函数。为此，只需在类实现部分中定义函数时使用`inline`限定符即可。
内联函数的特殊规则要求在每个使用它们的文件中都对其进行定义。取到内联定义对多文件程序中所有文件都可用的、最轻便的方法是：将内敛定义放在定义类的头文件中。
同时，根据改写规则，在类声明中定义方法等同于用原型替换方法定义，然后再类声明的后面将定义改写为内联函数。

### 一些其他的注意
调用成员函数时，他将使用被用来调用它的对象的数据成员。
所创建的每个新对象都有自己的存储空间，用于存储其内部变量和类成员；但同一个类的所有对象共享一组类方法，及每种方法只有一个副本。

### 使用类
在创建类对象时，可以声明类变量，也可以使用`new`来为类对象分配存储空间。可以将对象作为函数的参数和返回值，也可以将一个对象赋给另一个。

## 类的构造函数和析构函数
C++的目标之一就是像使用标准类型一样使用类对象。然而，到现在为止，我们并不能利用常规方法对类进行初始化。原因在于，类中的数据成员是私有的，只能够通过函数成员进行调用。所以我们需要设计合适的成员函数才能实现类的初始化。
### 声明和定义构造函数
现在需要创建Stock的构造函数。由于需要为Stock对象提供3个值，因此应为构造函数提供3个参数。因此，原型如下：
```cpp
Stack(const string& co, long n = 0, double pr = 0);
```
第一个参数是指向字符串的指针，该字符串用于初始化成员。n和pr参数为成员提供返回值。注意，没有返回类型。原型位于类声明的公有部分。
下面是构造函数一种可能定义：
```cpp
Stock::Stock(const string & co, long n, double pr)
{
   company = co;
   fi(n < 0 ){
      std::cer << "Number of shares can't be negative";
      shares = 0;
   }esle{
      shares = n;
   }
   share_vale = pr;
   set_tot();
}
```
程序在声明对象时会自动调用构造函数。
在构造函数中，可以灵活运用`this`指针。.
### 使用构造函数
C++提供了两种构造函数来初始化对象的方式。第一种方式是显式地调用构造函数。
```cpp
Stock food = Stock("Furry mason", 50, 2.5);
```
另一种是隐式地调用构造函数：
```cpp
Stock garment("Furry Mason", 50, 2.5)
```
每次创建类对象(甚至使用new动态分配内存)时，C++都是用类构造函数。
下面是将构造函数与`new`一起使用的方法。
```cpp
Stock *pstock = new Stock("Electroshock Games"，18， 19.0)；
```
这种情况下，对象没有名称，但可以使用指针来管理该对象。
构造函数的使用方式不同于其他类方法，一般来说，使用对象来调用方法；但无法使用使用对象来调用构造函数，因为在构造函数构造出对象之前，对象时不存在的。因此构造函数被用来创建对象，而不能通过对象来调用。
### 默认构造函数
默认构造函数是在未提供显式初始值时，用来创建对象的构造函数。如果没有提供任何构造函数，则C++将自动提供默认构造函数。他是默认构造函数的隐式版本，不做任何工作。如：
```cpp
Stock::Stock(){}
```
同时，我们要注意，当且仅当没有定义任何构造函数时，编译器才会提供默认构造函数。为类定义了构造函数后，程序员就必须为它提供默认构造函数。如果提供了非默认构造函数，而没有提供默认构造函数，则声明将出错。
这样做的原因可能是想创建未初始化的对象。然而，如果要创建对象，而不显式地初始化，则必须定义一个不接受任何参数的默认构造函数。
## 析构函数
用构造函数创建对象后，程序负责跟踪对象，直到其过期为止。对象过期时，程序将自动调用一个特殊的成员函数——析构函数。它将完成清理工作。例如，如果构造函数使用1`new`来分配内存，则析构函数将使用`delete`来释放这些内存。析构函数不需要进行特定的定义，编译器将自己决定进行定义和调用。
如果创建的的是静态存储对象，则其析构函数将在程序结束时自动调用。如果创建的是自动存储类对象，则其析构函数将在程序执行完代码块时(该对象时在其中定义的)自动被调用。如果对象是通过new来创建的，则它将驻留在栈内存或自由存储区中，当使用delete来释放内存是，其析构函数将自动被调用。最后，程序可以创建临时对象来完成特定的操作，在这种情况下，程序将在结束对该对象的使用时自动调用其析构函数。
由于在类对象过期时析构函数将自动被调用，因此必须有一个续后汉书。古国程序员没有提供虚构函数，编译器将隐式地声明一个默认析构函数，并在发现导致对象被删除的代码后，提供默认析构函数的定义。
## 构造函数和析构函数小结